<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BS Studio - Admin Dashboard</title>
    
    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.29.0/feather.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Firebase -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';
        import { getAuth } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js';
        
        const firebaseConfig = {
            apiKey: "AIzaSyDcb8nrURYAKdDdpxJzrA2lAj3XtKX_Oo4",
            authDomain: "bs-studio-app.firebaseapp.com",
            projectId: "bs-studio-app",
            storageBucket: "bs-studio-app.appspot.com",
            messagingSenderId: "123456789",
            appId: "1:123456789:web:abcd1234efgh5678"
        };
        
        window.firebaseApp = initializeApp(firebaseConfig);
        window.firebaseAuth = getAuth(window.firebaseApp);
    </script>
    
    <link rel="stylesheet" href="styles/admin.css">
</head>
<body>
    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>
    
    <!-- Main Dashboard -->
    <div id="dashboard" class="dashboard-container">
        <div class="dashboard-layout">
            <!-- Sidebar -->
            <div id="sidebar" class="sidebar">
                <!-- Sidebar Header -->
                <div class="sidebar-header">
                    <div class="sidebar-brand">
                        <div class="brand-logo">BS</div>
                        <div class="brand-info" id="brand-info">
                            <h1 class="brand-title">BS Studio</h1>
                            <p class="brand-subtitle">Admin Dashboard</p>
                        </div>
                    </div>
                    <button onclick="toggleSidebar()" class="sidebar-toggle">
                        <i data-feather="menu"></i>
                    </button>
                </div>
                
                <!-- Navigation -->
                <div class="sidebar-nav">
                    <button onclick="setActiveTab('dashboard')" class="nav-item active" data-tab="dashboard">
                        <i data-feather="bar-chart-3"></i>
                        <span class="nav-label">Dashboard</span>
                    </button>
                    <button onclick="setActiveTab('bookings')" class="nav-item" data-tab="bookings">
                        <i data-feather="calendar"></i>
                        <span class="nav-label">Bookings</span>
                        <span class="nav-count" id="booking-count">0</span>
                    </button>
                    <button onclick="setActiveTab('slots')" class="nav-item" data-tab="slots">
                        <i data-feather="clock"></i>
                        <span class="nav-label">Slots</span>
                    </button>
                    <button onclick="setActiveTab('services')" class="nav-item" data-tab="services">
                        <i data-feather="star"></i>
                        <span class="nav-label">Services</span>
                    </button>
                    <button onclick="setActiveTab('users')" class="nav-item" data-tab="users">
                        <i data-feather="users"></i>
                        <span class="nav-label">Users</span>
                    </button>
                    <button onclick="setActiveTab('settings')" class="nav-item" data-tab="settings">
                        <i data-feather="settings"></i>
                        <span class="nav-label">Settings</span>
                    </button>
                </div>
                
                <!-- Sidebar Footer -->
                <div class="sidebar-footer">
                    <div class="user-profile">
                        <div class="user-avatar" id="user-avatar">A</div>
                        <div class="user-info" id="user-info">
                            <p class="user-name" id="user-name">Admin User</p>
                            <p class="user-email" id="user-email">admin@bsstudio.com</p>
                        </div>
                    </div>
                    <button onclick="adminLogout()" class="logout-btn">
                        <i data-feather="log-out"></i>
                        <span class="logout-label">Logout</span>
                    </button>
                </div>
            </div>
            
            <!-- Main Content -->
            <div class="main-content">
                <!-- Top Bar -->
                <div class="top-bar">
                    <div class="top-bar-left">
                        <h2 class="page-title">
                            <i id="page-icon" data-feather="bar-chart-3"></i>
                            <span id="page-title-text">Dashboard</span>
                        </h2>
                    </div>
                    <div class="top-bar-right">
                        <button class="icon-btn notification-btn">
                            <i data-feather="bell"></i>
                            <span class="notification-dot"></span>
                        </button>
                        <button onclick="toggleTheme()" class="icon-btn">
                            <i id="theme-icon" data-feather="moon"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Content Area -->
                <div class="content-area">
                    <!-- Dashboard Content -->
                    <div id="dashboard-content" class="tab-content active">
                        <div class="content-header">
                            <div class="header-text">
                                <h1>Dashboard Overview</h1>
                                <p>Welcome back! Monitor bookings, services, and users.</p>
                            </div>
                            <div class="header-actions">
                                <button class="btn btn-secondary" onclick="exportData()">
                                    <i data-feather="download"></i>
                                    Export All
                                </button>
                            </div>
                        </div>
                        
                        <!-- Stats Grid -->
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div class="stat-icon bg-blue">
                                        <i data-feather="calendar"></i>
                                    </div>
                                    <div class="stat-change">
                                        <i data-feather="trending-up"></i>
                                        <span id="weekly-growth">+12%</span>
                                    </div>
                                </div>
                                <h3 class="stat-value" id="total-bookings">0</h3>
                                <p class="stat-title">Total Bookings</p>
                                <p class="stat-subtitle">This month</p>
                            </div>
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div class="stat-icon bg-green">
                                        <i data-feather="check"></i>
                                    </div>
                                    <div class="stat-change">
                                        <i data-feather="trending-up"></i>
                                        <span id="confirmed-growth">+8%</span>
                                    </div>
                                </div>
                                <h3 class="stat-value" id="confirmed-bookings">0</h3>
                                <p class="stat-title">Confirmed</p>
                                <p class="stat-subtitle">Ready to serve</p>
                            </div>
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div class="stat-icon bg-purple">
                                        <i data-feather="users"></i>
                                    </div>
                                    <div class="stat-change">
                                        <i data-feather="trending-up"></i>
                                        <span id="user-growth">+15%</span>
                                    </div>
                                </div>
                                <h3 class="stat-value" id="total-users">0</h3>
                                <p class="stat-title">Total Users</p>
                                <p class="stat-subtitle">Registered</p>
                            </div>
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div class="stat-icon bg-orange">
                                        <i data-feather="dollar-sign"></i>
                                    </div>
                                    <div class="stat-change">
                                        <i data-feather="trending-up"></i>
                                        <span id="revenue-growth">+23%</span>
                                    </div>
                                </div>
                                <h3 class="stat-value" id="total-revenue">Â¢0</h3>
                                <p class="stat-title">Revenue (GHS)</p>
                                <p class="stat-subtitle">This month</p>
                            </div>
                        </div>
                        
                        <!-- Charts Grid -->
                        <div class="charts-grid">
                            <div class="chart-card">
                                <div class="chart-header">
                                    <h2>Monthly Bookings</h2>
                                    <p>Trend over the last 6 months</p>
                                </div>
                                <div class="chart-container">
                                    <canvas id="bookings-chart"></canvas>
                                </div>
                            </div>
                            <div class="chart-card">
                                <div class="chart-header">
                                    <h2>Bookings by Service</h2>
                                    <p>Distribution of services booked</p>
                                </div>
                                <div class="chart-container">
                                    <canvas id="services-chart"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Dashboard Grid -->
                        <div class="dashboard-grid">
                            <!-- Recent Bookings -->
                            <div class="dashboard-card">
                                <div class="card-header">
                                    <h2>
                                        <i data-feather="sparkles" class="text-purple"></i>
                                        Recent Bookings
                                    </h2>
                                    <button class="view-all-btn" onclick="setActiveTab('bookings')">
                                        View All
                                        <i data-feather="chevron-right"></i>
                                    </button>
                                </div>
                                <div id="recent-bookings" class="booking-list">
                                    <!-- Populated by JS -->
                                </div>
                            </div>
                            
                            <!-- Quick Actions -->
                            <div class="dashboard-card">
                                <div class="card-header">
                                    <h2>
                                        <i data-feather="star" class="text-purple"></i>
                                        Quick Actions
                                    </h2>
                                </div>
                                <div class="quick-actions-grid">
                                    <button onclick="setActiveTab('bookings')" class="quick-action bg-purple">
                                        <i data-feather="calendar"></i>
                                        <div>
                                            <span>Manage Bookings</span>
                                            <small>View & update</small>
                                        </div>
                                    </button>
                                    <button onclick="setActiveTab('slots')" class="quick-action bg-blue">
                                        <i data-feather="clock"></i>
                                        <div>
                                            <span>Set Slots</span>
                                            <small>Schedule time</small>
                                        </div>
                                    </button>
                                    <button onclick="setActiveTab('services')" class="quick-action bg-green">
                                        <i data-feather="star"></i>
                                        <div>
                                            <span>Edit Services</span>
                                            <small>Update offerings</small>
                                        </div>
                                    </button>
                                    <button onclick="setActiveTab('settings')" class="quick-action bg-orange">
                                        <i data-feather="settings"></i>
                                        <div>
                                            <span>Settings</span>
                                            <small>Configure app</small>
                                        </div>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Bookings Content -->
                    <div id="bookings-content" class="tab-content">
                        <div class="content-header">
                            <div class="header-text">
                                <h1>Bookings Management</h1>
                                <p>Manage and track all customer appointments</p>
                            </div>
                            <div class="header-actions">
                                <div class="search-box">
                                    <i data-feather="search"></i>
                                    <input type="text" id="search-bookings" placeholder="Search bookings..." oninput="filterBookings()">
                                </div>
                                <select id="filter-status" onchange="filterBookings()">
                                    <option value="all">All Status</option>
                                    <option value="pending">Pending</option>
                                    <option value="confirmed">Confirmed</option>
                                    <option value="cancelled">Cancelled</option>
                                    <option value="completed">Completed</option>
                                </select>
                                <button onclick="toggleCalendarView()" class="btn btn-secondary">
                                    <i data-feather="calendar"></i>
                                    Calendar View
                                </button>
                            </div>
                        </div>
                        
                        <!-- Bookings Tabs -->
                        <div class="sub-tabs">
                            <button onclick="setBookingsTab('current')" class="sub-tab active" data-tab="current">
                                Current Bookings
                            </button>
                            <button onclick="setBookingsTab('deleted')" class="sub-tab" data-tab="deleted">
                                Recently Deleted
                            </button>
                        </div>
                        
                        <!-- Current Bookings -->
                        <div id="current-bookings" class="sub-tab-content active">
                            <!-- Calendar View Section -->
                            <div id="calendar-view" style="display: none;">
                                <div class="calendar-container">
                                    <div class="calendar-header">
                                        <h2 class="calendar-title" id="calendar-month-year">September 2025</h2>
                                        <div class="calendar-nav">
                                            <button onclick="prevMonth()"><i data-feather="chevron-left"></i></button>
                                            <button onclick="nextMonth()"><i data-feather="chevron-right"></i></button>
                                        </div>
                                    </div>
                                    <div class="calendar-grid">
                                        <div class="calendar-day-header">Sun</div>
                                        <div class="calendar-day-header">Mon</div>
                                        <div class="calendar-day-header">Tue</div>
                                        <div class="calendar-day-header">Wed</div>
                                        <div class="calendar-day-header">Thu</div>
                                        <div class="calendar-day-header">Fri</div>
                                        <div class="calendar-day-header">Sat</div>
                                        <div id="calendar-days"></div>
                                    </div>
                                </div>
                                <!-- Selected Date Bookings -->
                                <div id="selected-date-bookings" style="display: none;">
                                    <h3><i data-feather="calendar"></i> Bookings for <span id="selected-date-display"></span></h3>
                                    <div id="bookings-for-selected-date" class="booking-list-calendar">
                                        <!-- Bookings for selected date will be populated here -->
                                    </div>
                                </div>
                            </div>
                            
                            <!-- List View Section -->
                            <div id="list-view" class="bookings-grid">
                                <!-- Bookings will be populated by JavaScript -->
                            </div>
                        </div>
                        
                        <!-- Recently Deleted -->
                        <div id="deleted-bookings" class="sub-tab-content">
                            <div id="deleted-bookings-list" class="bookings-grid">
                                <!-- Deleted bookings will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Slots Content -->
                    <div id="slots-content" class="tab-content">
                        <div class="content-header">
                            <div class="header-text">
                                <h1>Slots Management</h1>
                                <p>Configure available appointment times</p>
                            </div>
                            <div class="header-actions">
                                <button class="btn btn-primary" onclick="resetSlotDefaults()">
                                    <i data-feather="refresh-cw"></i>
                                    Reset Defaults
                                </button>
                            </div>
                        </div>
                        <div class="slots-container">
                            <h3>Available Time Slots (Daily)</h3>
                            <div id="slots-grid" class="slots-grid">
                                <!-- Generated dynamically -->
                            </div>
                            <div style="margin-top: 2rem;">
                                <h3>Custom Slot Overrides</h3>
                                <p>Select a date and toggle availability below:</p>
                                <div class="date-picker-container">
                                    <input type="date" id="custom-slot-date" onchange="updateCustomSlotDate()">
                                    <button onclick="saveCustomSlots()" class="btn btn-primary">Save Changes</button>
                                </div>
                                <div id="custom-slots-container" style="margin-top: 1rem;"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Services Content -->
                    <div id="services-content" class="tab-content">
                        <div class="content-header">
                            <div class="header-text">
                                <h1>Services Management</h1>
                                <p>Manage your beauty service offerings</p>
                            </div>
                            <div class="header-actions">
                                <button class="btn btn-primary" onclick="showServiceModal()">
                                    <i data-feather="plus"></i>
                                    Add Service
                                </button>
                            </div>
                        </div>
                        <div id="services-grid" class="services-grid">
                            <!-- Services will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Users Content -->
                    <div id="users-content" class="tab-content">
                        <div class="content-header">
                            <div class="header-text">
                                <h1>Users Management</h1>
                                <p>Manage customer accounts and permissions</p>
                            </div>
                            <div class="header-actions">
                                <div class="search-box">
                                    <i data-feather="search"></i>
                                    <input type="text" id="search-users" placeholder="Search users..." oninput="filterUsers()">
                                </div>
                            </div>
                        </div>
                        <div id="users-grid" class="users-grid">
                            <!-- Users will be populated by JavaScript -->
                        </div>
                        <!-- Login History -->
                        <div class="login-history">
                            <h3>Recent Login Activity</h3>
                            <div id="login-history-container">
                                <!-- Will be populated from user login data -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Settings Content -->
                    <div id="settings-content" class="tab-content">
                        <div class="content-header">
                            <div class="header-text">
                                <h1>Settings</h1>
                                <p>Configure your studio preferences</p>
                            </div>
                        </div>
                        <div class="settings-grid">
                            <div class="settings-card">
                                <h2>
                                    <i data-feather="settings" class="text-purple"></i>
                                    Studio Settings
                                </h2>
                                <div class="settings-form">
                                    <div class="form-group">
                                        <label>Deposit Amount (GHS)</label>
                                        <input type="number" id="deposit-amount" value="50">
                                    </div>
                                    <div class="form-group">
                                        <label>Mobile Money Number</label>
                                        <input type="text" id="momo-number" value="+233 XX XXX XXXX">
                                    </div>
                                    <div class="form-group">
                                        <label>Booking Policy</label>
                                        <textarea id="booking-policy" rows="6">Please make a 50 cedis deposit to confirm your booking. Cancellations must be made 24 hours in advance.</textarea>
                                    </div>
                                </div>
                                <button class="btn btn-primary" onclick="saveSettings()">Save Settings</button>
                            </div>
                            <div class="settings-card">
                                <h2>
                                    <i data-feather="database" class="text-purple"></i>
                                    Data Sync
                                </h2>
                                <p>Sync local state with database.</p>
                                <button class="btn btn-secondary" onclick="syncToDatabase()">Sync Now</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Service Modal -->
    <div id="service-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="service-modal-title">Add New Service</h3>
                <button onclick="closeServiceModal()" class="close-btn">
                    <i data-feather="x"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="service-form" onsubmit="saveService(event)">
                    <div class="form-group">
                        <label>Service Name</label>
                        <input type="text" id="service-name" required>
                    </div>
                    <div class="form-group">
                        <label>Category</label>
                        <select id="service-category">
                            <option value="Classic">Classic</option>
                            <option value="Hybrid">Hybrid</option>
                            <option value="Volume">Volume</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Price (GHS)</label>
                            <input type="number" id="service-price" required>
                        </div>
                        <div class="form-group">
                            <label>Duration (min)</label>
                            <input type="number" id="service-duration" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="service-description" rows="3"></textarea>
                    </div>
                    <div class="modal-actions">
                        <button type="submit" class="btn btn-primary">
                            <span id="service-submit-text">Create Service</span>
                        </button>
                        <button type="button" onclick="closeServiceModal()" class="btn btn-secondary">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <script src="admin.js"></script>
</body>
</html>